<!DOCTYPE html>
<html>
<head>
	<title>This is Safari Test</title>
	
	<script type="text/javascript">
  (function(p,u,s,h){
      p._pcq=p._pcq||[];
      p._pcq.push(['_currentTime',Date.now()]);
p._pcq.push(['noTrigger',true]);
      s=u.createElement('script');
      s.type='text/javascript';
      s.async=true;
      s.src='https://cdn.pushcrew.com/js/8a821bc2cbf301fc3bec17f55f16ab11.js';
      h=u.getElementsByTagName('script')[0];
      h.parentNode.insertBefore(s,h);
  })(window,document);
</script>
	<script>
		_pcq.push(['APIReady', callbackOnSuccessFunction,callbackOnFailureFunction]); //will execute callback function when PushCrew API is ready

function callbackOnSuccessFunction() {
    console.log("now api is ready");
	console.log(pushcrew.subscriberId);
	_pcq.push(['triggerOptIn']);
	_pcq.push(['addSubscriberToSegment', 'homepage. 2', callbackForAddToSegment]);
}

function callbackForAddToSegment(response) {
    if(response === -1) {
        console.log('User is not a subscriber or has blocked notifications');
    }
  
    if(response === false) {
        console.log('Segment name provided is not valid. Maximum length of segment name can be 30 chars and it can only contain alphanumeric characters, underscore and dash.');
    }
  
    if(response === true) {
        console.log('User got added to the segment successfully. Now you may run any code you wish to execute after user gets added to segment successfully');
    }
}

function callbackOnFailureFunction(values) {
    console.log(values.reasons) //It will give you the array of reasons why PushCrew API could not get ready .For eg:- ["PRIVATE_BROWSING", "BROWSER_NOT_SUPPORTED"] etc.
}
	</script>
	<script>
		_pcq.push(['subscriptionSuccessCallback',callbackFunctionOnSuccessfulSubscription]); //registers callback function to be called when user gets successfully subscribed

function callbackFunctionOnSuccessfulSubscription(subscriberId, values) {
    console.log('User got successfully subscribed.');

    console.log(subscriberId); //will output the user's subscriberId

    console.log(values.status); // SUBSCRIBED or ALREADYSUBSCRIBED

    console.log(values.message) // 'User has subscribed to push notifications.' or 'User is already subscribed to push notifications.'

    console.log('Now you may run code which should be executed once user gets successfully subscribed.');
}
		_pcq.push(['subscriptionFailureCallback',callbackFunctionOnFailedSubscription]); //registers callback function to be called when user gets successfully subscribed

function callbackFunctionOnFailedSubscription(values) {
    console.log('User could not get subscribed to push notifications');

    console.log(values.status); // BLOCKED , UNSUBSCRIBED or CANCELLED

    console.log(values.message) // 'User has blocked push notifications.', 'User has unsubscribed from push notifications', 'No change in subscription. Child window was closed.' or 'User has closed the notifications opt-in.'

    console.log('Now you may run code which should be executed once user subscription fails');
}
	</script>
	
</head>
<body>
<h1>Safari Test in progress</h1>
</body>
</html>
